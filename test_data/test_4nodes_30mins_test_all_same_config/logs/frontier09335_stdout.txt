{ProcessCoord(pipe=0, data=0, model=0): 0, ProcessCoord(pipe=0, data=1, model=0): 1, ProcessCoord(pipe=0, data=2, model=0): 2, ProcessCoord(pipe=0, data=3, model=0): 3, ProcessCoord(pipe=0, data=4, model=0): 4, ProcessCoord(pipe=0, data=5, model=0): 5, ProcessCoord(pipe=0, data=6, model=0): 6, ProcessCoord(pipe=0, data=7, model=0): 7, ProcessCoord(pipe=0, data=8, model=0): 8, ProcessCoord(pipe=0, data=9, model=0): 9, ProcessCoord(pipe=0, data=10, model=0): 10, ProcessCoord(pipe=0, data=11, model=0): 11, ProcessCoord(pipe=0, data=12, model=0): 12, ProcessCoord(pipe=0, data=13, model=0): 13, ProcessCoord(pipe=0, data=14, model=0): 14, ProcessCoord(pipe=0, data=15, model=0): 15}
Time to load fused_lamb op: 38.97427463531494 seconds
Time to load utils op: 18.136765241622925 seconds
Rank: 14 partition count [16, 16] and sizes[(90122496, False), (40506, False)] 
Time to load utils op: 0.002106904983520508 seconds
WARNING: shuffle index length (125509964) is not equal to sample index length (125509965)
WARNING: shuffle index length (601642) is not equal to sample index length (601643)
WARNING: shuffle index length (19315) is not equal to sample index length (19316)
model.save_ckpt!!
save_ds_ckpt done!!

includes/type_shim_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/lamb/fused_lamb_cuda_kernel.cu -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/lamb/fused_lamb_hip_kernel.hip [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/ds_kernel_utils.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/ds_kernel_utils_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/StopWatch.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/StopWatch.h [skipped, no changes]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/cublas_wrappers.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/cublas_wrappers_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/gemm_test.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/gemm_test_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/context.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/context_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/custom_cuda_layers.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/custom_hip_layers.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/softmax.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/softmax_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/ds_kernel_utils.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/ds_kernel_utils_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/Timer.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/Timer_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/dropout.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/dropout_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/feed_forward.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/feed_forward_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/gelu.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/gelu_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/general_kernels.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/general_kernels_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/normalize_layer.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/normalize_layer_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/strided_batch_gemm.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/strided_batch_gemm_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/ds_transformer_cuda.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/ds_transformer_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/feed_forward.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/feed_forward_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/conversion_utils.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/conversion_utils_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/type_shim.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/type_shim_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/memory_access_utils.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/memory_access_utils_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/reduction_utils.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/reduction_utils_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/simd.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/simd.h [skipped, no changes]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/cpu_adam.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/cpu_adam_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/simd.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/simd.h [skipped, no changes]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/gelu.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/gelu_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/quantization.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/quantization_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/general_kernels.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/general_kernels_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/dropout.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/dropout_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/quantization_utils.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/quantization_utils_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/dequantization_utils.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/dequantization_utils_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/quantizer.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/quantizer_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/custom_cuda_layers.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/custom_hip_layers.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/normalize_layer.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/normalize_layer_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/compat.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/compat.h [skipped, no changes]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/cpu_adagrad.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/cpu_adagrad_hip.h [ok]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/cublas_wrappers.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/cublas_wrappers_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/memory_access_utils.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/memory_access_utils_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/StopWatch.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/StopWatch.h [skipped, no changes]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/strided_batch_gemm.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/strided_batch_gemm_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/gemm_test.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/gemm_test_hip.h [skipped, already hipified]
/lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/context.h -> /lustre/orion/gen243/proj-shared/bbdir/forge/conda-env-forge/lib/python3.8/site-packages/deepspeed/ops/csrc/includes/context_hip.h [skipped, already hipified]
Total number of unsupported CUDA function calls: 0


Total number of replaced kernel launches: 6
Time to load fused_lamb op: 39.77259159088135 seconds
Time to load utils op: 18.137295722961426 seconds
Rank: 9 partition count [16, 16] and sizes[(90122496, False), (40506, False)] 
Time to load utils op: 0.0021278858184814453 seconds
WARNING: shuffle index length (125509964) is not equal to sample index length (125509965)
WARNING: shuffle index length (601642) is not equal to sample index length (601643)
WARNING: shuffle index length (19315) is not equal to sample index length (19316)
model.save_ckpt!!
save_ds_ckpt done!!
